import{env as u,pipeline as f}from"https://cdn.jsdelivr.net/npm/@xenova/transformers@2.6.0";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const i of t.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function c(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function o(e){if(e.ep)return;e.ep=!0;const t=c(e);fetch(e.href,t)}})();u.allowLocalModels=!1;const m=document.getElementById("file-upload"),d=document.getElementById("image-container"),l=document.getElementById("status");l.textContent="Loading model...";const p=await f("object-detection","Xenova/detr-resnet-50");l.textContent="Ready";m.addEventListener("change",function(r){const n=r.target.files[0];if(!n)return;const c=new FileReader;c.onload=function(o){d.innerHTML="";const e=document.createElement("img");e.src=o.target.result,d.appendChild(e),g(e)},c.readAsDataURL(n)});async function g(r){l.textContent="Analysing...";const n=await p(r.src,{threshold:.5,percentage:!0});l.textContent="",console.log("output",n),n.forEach(y)}function y({box:r,label:n}){const{xmax:c,xmin:o,ymax:e,ymin:t}=r,i="#"+Math.floor(Math.random()*16777215).toString(16).padStart(6,0),s=document.createElement("div");s.className="bounding-box",Object.assign(s.style,{borderColor:i,left:100*o+"%",top:100*t+"%",width:100*(c-o)+"%",height:100*(e-t)+"%"});const a=document.createElement("span");a.textContent=n,a.className="bounding-box-label",a.style.backgroundColor=i,s.appendChild(a),d.appendChild(s)}
